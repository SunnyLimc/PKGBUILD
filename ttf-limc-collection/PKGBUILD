pkgbase=ttf-limc-collection
pkgname=(ttf-{windows,firacode,firacode-nf,lxgw-wenkai-screen,lxgw-cleargothic-book})
pkgver=0.0.1
pkgrel=1
license=('custom')
pkgdesc='A font collection made by limc and aims to provide zh-* users a better experience'
url='https://github.com/SunnyLimc/PKGBUILD/tree/main/ttf-limc-collection'
arch=('any')
provides=('ttf-limc-collection')
makedepends=(
  'unzip'
)
source=(
  'FiraCode.zip::https://github.com/tonsky/FiraCode/releases/download/6.2/Fira_Code_v6.2.zip'
  'FiraCodeNF.zip::https://github.com/ryanoasis/nerd-fonts/releases/download/v2.2.2/FiraCode.zip'
  'https://github.com/lxgw/LxgwWenKai-Screen/releases/download/v1.245/LXGWWenKaiScreen.ttf'
  'https://github.com/lxgw/LxgwWenKai-Screen/releases/download/v1.245/LXGWWenKaiScreenR.ttf'
  'https://github.com/lxgw/LxgwNewClearGothic/releases/download/v0.235/LXGWNewClearGothic-Book.ttf'
)
sha256sums=(
)

pkgver() {
  printf "r%s" "$(git rev-list --count HEAD)"
}

#! put your ttf/ttc file extract from windows DIRECTLY
#! (without wrap by any folder) in a zip archive named 'windows_fonts.zip'
package_ttf-windows() {
  [[ ! -f "windows_fonts.zip" ]] && return 0
  mkdir -p "$pkgname"
  unzip -q -o 'windows_fonts.zip' -d "$pkgname"
  local fonts
  mapfile -t fonts < <(ls -d "$pkgname"/*.ttf)
  mapfile -O ${#fonts[@]} -t fonts < <(ls -d "$pkgname"/*.ttc)
  [[ -z ${#fonts[@]} ]] && return 0
  provides+=(emoji-font ttf-tahoma ttf-ms-fonts)
  conflicts+=(ttf-tahoma ttf-ms-fonts)
  for i in ${fonts[@]}; do
    install -Dm644 "$i" -t "$pkgdir/usr/share/fonts/TTF"
  done
}

package_ttf-firacode() {
  mkdir -p "$pkgname"
  unzip -q -o 'FiraCode.zip' -d "$pkgname"
  local fonts
  mapfile -t fonts < <(ls -d "$pkgname"/ttf/*)
  for i in ${fonts[@]}; do
    install -Dm644 "$i" -t "$pkgdir/usr/share/fonts/TTF"
  done
}

package_ttf-firacode-nf() {
  mkdir -p "$pkgname"
  unzip -q -o 'FiraCodeNF.zip' -d "$pkgname"
  local fonts
  mapfile -t fonts < <(ls -d "$pkgname"/*Mono.ttf)
  mapfile -O ${#fonts[@]} -t fonts < <(ls -d "$pkgname"/*Complete.ttf)
  for i in ${fonts[@]}; do
    install -Dm644 "$i" -t "$pkgdir/usr/share/fonts/TTF"
  done
  install -Dm644 "$pkgname/LICENSE" -t "$pkgdir/usr/share/licenses/$pkgname"
}

package_ttf-lxgw-wenkai-screen() {
  mkdir -p "$pkgname"
  local fonts=('LXGWWenKaiScreen.ttf' 'LXGWWenKaiScreenR.ttf')
  for i in ${fonts[@]}; do
    install -Dm644 "$i" -t "$pkgdir/usr/share/fonts/TTF"
  done
}

package_ttf-lxgw-cleargothic-book() {
  mkdir -p "$pkgname"
  local fonts=('LXGWNewClearGothic-Book.ttf')
  for i in ${fonts[@]}; do
    install -Dm644 "$i" -t "$pkgdir/usr/share/fonts/TTF"
  done
}
