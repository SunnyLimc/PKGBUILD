pkgname=wlroots-hidpi-git
<<<<<<< HEAD
pkgver=0.15.1.r5802.c2d2773d
=======
pkgver=0.16.0.r5808.4d04144b
>>>>>>> staging
pkgrel=1
license=('MIT')
pkgdesc='Modular Wayland compositor library (git ver, hidpi patch, commit revert)'
url='https://gitlab.freedesktop.org/wlroots/wlroots'
arch=('x86_64')
provides=("libwlroots.so" "wlroots=${pkgver/.r*/}" "wlroots-git")
conflicts=("wlroots" "wlroots-git")
depends=(
	'libinput'
	'libxcb'
	'opengl-driver'
	'xcb-util-errors'
	'xcb-util-renderutil'
	'xcb-util-wm'

	'libseat.so'
	'libudev.so'
	'libvulkan.so'
	'libpixman-1.so'
	'libxkbcommon.so'
	'libwayland-client.so'
	'libwayland-server.so'
)
makedepends=(
	'git'
	'glslang'
	'meson'
	'systemd'
	'vulkan-headers'
	'wayland-protocols'
	'xorg-xwayland'
)
source=(
	"${pkgname}::git+${url}.git"
<<<<<<< HEAD
	"https://gitlab.freedesktop.org/lilydjwg/wlroots/-/commit/6c5ffcd1fee9e44780a6a8792f74ecfbe24a1ca7.diff"
)
<<<<<<< HEAD
<<<<<<< HEAD
sha256sums=(
=======
sha256sum=(
>>>>>>> 3ed916b (feat(pack): add wlroots-git)
=======
sha256sums=(
>>>>>>> d96b333 (fix(pkg): sha256sums typo)
=======
	"hidpi.patch::https://gitlab.freedesktop.org/lilydjwg/wlroots/-/commit/6c5ffcd1fee9e44780a6a8792f74ecfbe24a1ca7.diff"
)
sha256sums=(
>>>>>>> staging
	'SKIP'
	'403f2d4009a0d3c98191b1033e575c9c1c606904c67b5d217b4bae06d0f2ba2c'
)
pkgver() {
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
=======
>>>>>>> 8c662be (fix: remove duplicate lines from wlroots)
=======
>>>>>>> staging
	cd "${pkgname}"
	set -o pipefail
	grep -zoP "project\([^)]*\)" meson.build | xargs --null echo | perl -ne '/\sversion:\s'"'"'([0-9.]*).*'"'"'/ and print $1'
	printf ".r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
<<<<<<< HEAD
<<<<<<< HEAD
}

prepare() {
	cd "${pkgname}"
	git revert -n 18595000f3a21502fd60bf213122859cc348f9af
	patch -N -p1 <../6c5ffcd1fee9e44780a6a8792f74ecfbe24a1ca7.diff
}

build() {
=======
}

build() {
	git -C "${pkgname}" revert -n 18595000f3a21502fd60bf213122859cc348f9af
	patch -N -p1 -d "${pkgname}" < hidpi.patch
>>>>>>> staging
	arch-meson "${pkgname}" build
	meson compile -C build
}

package() {
	meson install -C build --destdir "${pkgdir}"
	install -Dm644 "${pkgname}/LICENSE" -t "${pkgdir}/usr/share/licenses/${pkgname}"
}
<<<<<<< HEAD
=======
  cd "${pkgname}"
  set -o pipefail
  grep -zoP "project\([^)]*\)" meson.build | xargs --null echo | perl -ne '/\sversion:\s'"'"'([0-9.]*).*'"'"'/ and print $1'
  printf ".r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
=======
>>>>>>> 8c662be (fix: remove duplicate lines from wlroots)
}

prepare() {
	cd "${pkgname}"
	git revert -n 18595000f3a21502fd60bf213122859cc348f9af
	patch -N -p1 <../6c5ffcd1fee9e44780a6a8792f74ecfbe24a1ca7.diff
}

build() {
	arch-meson "${pkgname}" build
	meson compile -C build
}

package() {
	meson install -C build --destdir "${pkgdir}"
	install -Dm644 "${pkgname}/LICENSE" -t "${pkgdir}/usr/share/licenses/${pkgname}"
}
<<<<<<< HEAD
  
sha256sums=('SKIP'
            '403f2d4009a0d3c98191b1033e575c9c1c606904c67b5d217b4bae06d0f2ba2c')
>>>>>>> 3ed916b (feat(pack): add wlroots-git)
=======
>>>>>>> 8c662be (fix: remove duplicate lines from wlroots)
=======
>>>>>>> staging
